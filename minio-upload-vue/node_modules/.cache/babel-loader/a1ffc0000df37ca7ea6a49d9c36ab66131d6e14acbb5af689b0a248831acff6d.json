{"ast":null,"code":"import { md5 } from '../utils/md5';\nimport { initTask,\n// getPresignedObjectUrl,\ngetTaskInfo\n// merge\n} from '../api/upload';\n// import { Notification } from 'element-ui';\n\nexport default {\n  methods: {\n    async handleHttpRequest(options) {\n      // 查询文件有无对应上传任务\n      const file = options.file;\n      console.log(file);\n      const identifier = md5(file);\n      console.log(identifier);\n      const {\n        data\n      } = await getTaskInfo(identifier);\n      console.log(\"查询有无上传任务\" + data);\n      let task = null;\n      // 没有任务则新建任务\n      if (!data) {\n        const {\n          data\n        } = await initTask(identifier, file.size, 5 * 1024 * 1024, file.name);\n        console.log(\"新建任务\" + data);\n        if (data) {\n          task = data;\n        } else {\n          this.$notify.error({\n            title: \"错误\",\n            message: \"创建上传任务失败！\"\n          });\n        }\n      }\n      if (task) {\n        // 处理上传\n        console.log(task);\n      } else {\n        this.$notify.error({\n          title: \"错误\",\n          message: \"文件上传错误\"\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["md5","initTask","getTaskInfo","methods","handleHttpRequest","options","file","console","log","identifier","data","task","size","name","$notify","error","title","message"],"sources":["src/views/UploadView.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-upload \r\n            class=\"upload-demo\" \r\n            drag \r\n            action=\"https://jsonplaceholder.typicode.com/posts/\" \r\n            multiple\r\n            :http-request=handleHttpRequest>\r\n            <i class=\"el-icon-upload\"></i>\r\n            <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n        </el-upload>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { md5 } from '../utils/md5';\r\nimport {\r\n    initTask,\r\n    // getPresignedObjectUrl,\r\n    getTaskInfo,\r\n    // merge\r\n} from '../api/upload';\r\n// import { Notification } from 'element-ui';\r\n\r\nexport default {\r\n    methods: {\r\n        async handleHttpRequest(options) {\r\n            // 查询文件有无对应上传任务\r\n            const file = options.file;\r\n            console.log(file);\r\n            const identifier = md5(file);\r\n            console.log(identifier);\r\n            \r\n            const { data } = await getTaskInfo(identifier);\r\n            console.log(\"查询有无上传任务\" + data);\r\n            let task = null;\r\n            // 没有任务则新建任务\r\n            if (!data) { \r\n                const { data } = await initTask(identifier, file.size, 5 * 1024 * 1024, file.name);\r\n                console.log(\"新建任务\" + data);\r\n                if (data) {\r\n                    task = data;\r\n                } else {\r\n                    this.$notify.error({\r\n                        title: \"错误\",\r\n                        message: \"创建上传任务失败！\"\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (task) { // 处理上传\r\n                console.log(task);\r\n            } else {\r\n                this.$notify.error({\r\n                    title: \"错误\",\r\n                    message: \"文件上传错误\"\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped></style>"],"mappings":"AAeA,SAAAA,GAAA;AACA,SACAC,QAAA;AACA;AACAC;AACA;AAAA,OACA;AACA;;AAEA;EACAC,OAAA;IACA,MAAAC,kBAAAC,OAAA;MACA;MACA,MAAAC,IAAA,GAAAD,OAAA,CAAAC,IAAA;MACAC,OAAA,CAAAC,GAAA,CAAAF,IAAA;MACA,MAAAG,UAAA,GAAAT,GAAA,CAAAM,IAAA;MACAC,OAAA,CAAAC,GAAA,CAAAC,UAAA;MAEA;QAAAC;MAAA,UAAAR,WAAA,CAAAO,UAAA;MACAF,OAAA,CAAAC,GAAA,cAAAE,IAAA;MACA,IAAAC,IAAA;MACA;MACA,KAAAD,IAAA;QACA;UAAAA;QAAA,UAAAT,QAAA,CAAAQ,UAAA,EAAAH,IAAA,CAAAM,IAAA,mBAAAN,IAAA,CAAAO,IAAA;QACAN,OAAA,CAAAC,GAAA,UAAAE,IAAA;QACA,IAAAA,IAAA;UACAC,IAAA,GAAAD,IAAA;QACA;UACA,KAAAI,OAAA,CAAAC,KAAA;YACAC,KAAA;YACAC,OAAA;UACA;QACA;MACA;MAEA,IAAAN,IAAA;QAAA;QACAJ,OAAA,CAAAC,GAAA,CAAAG,IAAA;MACA;QACA,KAAAG,OAAA,CAAAC,KAAA;UACAC,KAAA;UACAC,OAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}